<html>
  <head>
    <script src="node_modules/webmidi/webmidi.min.js"></script>
    <script type="text/javascript" src="node_modules/midiconvert/build/MidiConvert.js"></script>
    <script src="js/markovDuration.js"></script>
    <script src="js/markovNote.js"></script>
    <script src="js/bigramModel.js"></script>
    <script src="js/playMusic.js"></script>
    <script src="js/metrics.js"></script>
    <script src="js/generateEpisode.js"></script>
    <script src="js/parseMIDIFile.js"></script>
    <script src="js/bundle.js"></script>
  </head>
  <body>

    <div>
      <input type="button" onclick="document.getElementById('fu').click()"
      value="Click to select file" />
      <span id="fileName"></span>
    </div>
    <input type="file" id="fu" onchange="FileSelected()" style="width: 0;">
    <div>
      <button type="button" onclick="start()">start</button>
      <button type="button" onclick="stop()">stop</button>
    </div>

    <div id="generate_music"></div>

    <script type="text/javascript">
    function FileSelected(e) {
      file = document.getElementById('fu').files[document.getElementById('fu').files.length - 1];
      document.getElementById('fileName').innerHtml= file.name;
      parseFile(file.name);
    }
    WebMidi.enable(function (err) {
      var output = WebMidi.outputs[0];
      var input = WebMidi.inputs[0];
      console.log(WebMidi.outputs);
      //output.playNote("C4");
      input.addListener('noteon', 1,
         function (e) {
           readNote(WebMidi.noteNameToNumber(e.note.name + e.note.octave));
           start_duration((e.note.name + e.note.octave), e.timestamp);
         }
        );
      input.addListener('noteoff', 1,
        function (e) {
          stop_duration((e.note.name + e.note.octave), e.timestamp);
        });
      });

    </script>
  </body>
</html>
